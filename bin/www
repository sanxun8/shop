#!/usr/bin/env node

const app = require('../app');
const db = require('../models/index.js');

process.on('uncaughtException', (err) => {
  console.error(err.message);
});
process.on('unhandledRejection', (err) => {
  console.error(err.message);
});

global.db = db;
db.sequelize
  .authenticate()
  .then(() => {
    const port = 3000;

    const server = app.listen(port);
    server.on('error', function (err) {
      console.err(err.message);
    });
    server.on('listening', function () {
      console.log(`server is running in http://localhost:${port}`);
    });
  })
  .catch((err) => {
    console.error('Unable to connect to the database:', err.message);
  });
